{% extends 'base.html' %}

{% block title %}Official Academic Transcript - JRIT{% endblock %}

{% block content %}
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Official Transcript - {{ student.full_name if student else 'Student' }} | JRIT</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;500;600;700&family=Playfair+Display:wght@400;500;600&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-color: #1a365d;
            --secondary-color: #2c5282;
            --accent-color: #4299e1;
            --gold-accent: #4299e1;
            --success-color: #38a169;
            --warning-color: #dd6b20;
            --danger-color: #e53e3e;
            --light-bg: #f7fafc;
            --border-color: #e2e8f0;
            --paper-color: #fffef9;
            --text-color: #2d3748;
            --muted-text: #718096;
        }
        
        @page {
            size: A4;
            margin: 0;
        }
        
        body {
            background-color: #edf2f7;
            font-family: 'Montserrat', sans-serif;
            color: var(--text-color);
            line-height: 1.7;
            -webkit-print-color-adjust: exact !important;
            print-color-adjust: exact !important;
        }
        
        .transcript-container {
            width: 210mm;
            min-height: 297mm;
            margin: 20px auto;
            background: var(--paper-color);
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.12);
            position: relative;
            padding: 30mm;
            box-sizing: border-box;
            border: 1px solid #e2e8f0;
            overflow: hidden;
        }
        
        .transcript-header {
            text-align: center;
            padding-bottom: 25px;
            margin-bottom: 35px;
            position: relative;
        }
        
        .header-border {
            height: 10px;
            background: linear-gradient(90deg, 
                var(--primary-color) 0%, 
                var(--accent-color) 50%, 
                var(--gold-accent) 100%);
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            border-radius: 5px;
        }
        
        .institute-logo {
            width: 110px;
            height: 110px;
            margin: 0 auto 20px;
            border-radius: 50%;
            border: 3px solid var(--gold-accent);
            padding: 8px;
            background: white;
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
            transition: transform 0.3s ease;
        }
        
        .institute-logo:hover {
            transform: scale(1.05);
        }
        
        .institute-logo img {
            width: 100%;
            height: 100%;
            object-fit: contain;
            filter: drop-shadow(0 2px 4px rgba(0,0,0,0.1));
        }
        
        .document-title {
            font-family: 'Playfair Display', serif;
            font-size: 32px;
            font-weight: 600;
            color: var(--primary-color);
            letter-spacing: 1.5px;
            margin: 20px 0 10px;
            position: relative;
            text-shadow: 1px 1px 3px rgba(0,0,0,0.05);
        }
        
        .document-subtitle {
            font-size: 17px;
            color: var(--muted-text);
            margin-bottom: 15px;
            font-weight: 400;
            letter-spacing: 0.5px;
        }
        
        .student-profile {
            display: flex;
            justify-content: space-between;
            margin-bottom: 45px;
            flex-wrap: wrap;
            align-items: center;
            background: white;
            padding: 25px;
            border-radius: 10px;
            box-shadow: 0 8px 30px rgba(0,0,0,0.06);
            border-left: 6px solid var(--accent-color);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        
        .student-profile:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 35px rgba(0,0,0,0.1);
        }
        
        .profile-picture {
            width: 160px;
            height: 190px;
            border: 1px solid var(--border-color);
            padding: 8px;
            background: white;
            box-shadow: 0 8px 25px rgba(0,0,0,0.08);
            position: relative;
            overflow: hidden;
            transition: transform 0.3s ease;
        }
        
        .profile-picture:hover {
            transform: scale(1.03);
        }
        
        .profile-picture::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 6px;
            background: linear-gradient(90deg, var(--primary-color), var(--accent-color));
        }
        
        .profile-picture img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.3s ease;
        }
        
        .profile-picture:hover img {
            transform: scale(1.02);
        }
        
        .student-info {
            flex: 1;
            padding: 0 35px;
        }
        
        .student-info h2 {
            font-family: 'Playfair Display', serif;
            font-size: 24px;
            font-weight: 600;
            color: var(--primary-color);
            margin-bottom: 18px;
            padding-bottom: 10px;
            position: relative;
            border-bottom: 2px solid var(--border-color);
        }
        
        .student-info h2::after {
            content: "";
            position: absolute;
            width: 60px;
            height: 3px;
            background: var(--gold-accent);
            bottom: -2px;
            left: 0;
        }
        
        .info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 15px;
        }
        
        .info-item {
            margin-bottom: 12px;
        }
        
        .info-label {
            font-weight: 600;
            color: var(--secondary-color);
            font-size: 14px;
            display: block;
            margin-bottom: 3px;
        }
        
        .info-value {
            font-weight: 500;
            font-size: 15px;
            color: var(--text-color);
            padding-left: 5px;
        }
        
        .academic-summary {
            margin-bottom: 45px;
        }
        
        .section-title {
            font-family: 'Playfair Display', serif;
            font-size: 24px;
            font-weight: 600;
            color: var(--primary-color);
            margin-bottom: 25px;
            padding-bottom: 10px;
            position: relative;
            letter-spacing: 0.5px;
        }
        
        .section-title::after {
            content: "";
            position: absolute;
            width: 100px;
            height: 4px;
            background: linear-gradient(90deg, var(--gold-accent), var(--accent-color));
            bottom: -2px;
            left: 0;
            border-radius: 2px;
        }
        
        .summary-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
            gap: 25px;
            margin-bottom: 35px;
        }
        
        .summary-card {
            background: white;
            border-radius: 10px;
            padding: 25px;
            box-shadow: 0 8px 30px rgba(0,0,0,0.08);
            text-align: center;
            transition: all 0.4s ease;
            position: relative;
            overflow: hidden;
            border-top: 6px solid var(--accent-color);
        }
        
        .summary-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 15px 40px rgba(0,0,0,0.12);
        }
        
        .summary-card::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 6px;
            background: var(--accent-color);
        }
        
        .summary-card h3 {
            font-size: 17px;
            font-weight: 600;
            margin: 0 0 18px 0;
            color: var(--secondary-color);
            letter-spacing: 0.5px;
        }
        
        .summary-value {
            font-size: 36px;
            font-weight: 700;
            margin: 20px 0;
            position: relative;
            font-family: 'Playfair Display', serif;
        }
        
        .summary-value::after {
            content: "";
            position: absolute;
            width: 50px;
            height: 4px;
            background: var(--gold-accent);
            bottom: -12px;
            left: 50%;
            transform: translateX(-50%);
            border-radius: 2px;
        }
        
        .overall-gpa {
            color: var(--primary-color);
            background: linear-gradient(135deg, var(--primary-color), var(--accent-color));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            display: inline-block;
        }
        
        .pass-rate {
            color: var(--success-color);
        }
        
        .summary-card p {
            font-size: 14px;
            color: var(--muted-text);
            margin-top: 20px;
        }
        
        .semester-section {
            margin-bottom: 45px;
            page-break-inside: avoid;
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 8px 30px rgba(0,0,0,0.08);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        
        .semester-section:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 35px rgba(0,0,0,0.12);
        }
        
        .semester-header {
            background: linear-gradient(90deg, var(--primary-color), var(--secondary-color));
            color: white;
            padding: 15px 25px;
            font-weight: 600;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .semester-title {
            font-size: 19px;
            letter-spacing: 0.5px;
            font-family: 'Playfair Display', serif;
        }
        
        .semester-gpa {
            background: rgba(255, 255, 255, 0.15);
            padding: 6px 18px;
            border-radius: 20px;
            font-size: 16px;
            font-weight: 500;
            backdrop-filter: blur(5px);
        }
        
        .subject-table {
            width: 100%;
            border-collapse: collapse;
        }
        
        .subject-table th {
            background: var(--light-bg);
            padding: 14px 18px;
            text-align: left;
            font-weight: 600;
            color: var(--secondary-color);
            border-bottom: 2px solid var(--border-color);
            font-size: 14px;
            letter-spacing: 0.5px;
            text-transform: uppercase;
        }
        
        .subject-table td {
            padding: 14px 18px;
            border-bottom: 1px solid var(--border-color);
            vertical-align: middle;
            font-size: 15px;
        }
        
        .subject-table tr:last-child td {
            border-bottom: none;
        }
        
        .subject-table tr:hover td {
            background-color: rgba(66, 153, 225, 0.05);
        }
        
        .grade-badge {
            padding: 6px 12px;
            border-radius: 20px;
            font-weight: 600;
            text-align: center;
            display: inline-block;
            min-width: 50px;
            font-size: 15px;
            box-shadow: 0 3px 8px rgba(0,0,0,0.1);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        
        .grade-badge:hover {
            transform: scale(1.05);
            box-shadow: 0 5px 15px rgba(0,0,0,0.15);
        }
        
        .grade-A { 
            background: linear-gradient(135deg, var(--success-color), #2f855a);
            color: white;
        }
        .grade-B { 
            background: linear-gradient(135deg, var(--accent-color), #3182ce);
            color: white;
        }
        .grade-C { 
            background: linear-gradient(135deg, var(--warning-color), #dd6b20);
            color: white;
        }
        .grade-D { 
            background: linear-gradient(135deg, #ed8936, #c05621);
            color: white;
        }
        .grade-F { 
            background: linear-gradient(135deg, var(--danger-color), #c53030);
            color: white;
        }
        
        .transcript-footer {
            margin-top: 60px;
            padding-top: 35px;
            border-top: 2px solid var(--border-color);
            display: flex;
            justify-content: space-between;
            flex-wrap: wrap;
        }
        
        .footer-note {
            font-size: 14px;
            color: var(--muted-text);
            max-width: 65%;
            line-height: 1.7;
        }
        
        .footer-note strong {
            color: var(--primary-color);
            font-weight: 600;
        }
        
        .signature-area {
            text-align: center;
            flex: 1;
            min-width: 250px;
            position: relative;
        }
        
        .signature-line {
            width: 220px;
            height: 1px;
            background: var(--text-color);
            margin: 60px auto 10px;
            border-top: 1px dashed var(--muted-text);
        }
        
        .signature-text {
            font-weight: 600;
            color: var(--primary-color);
            margin-bottom: 5px;
            font-family: 'Playfair Display', serif;
        }
        
        .signature-stamp {
            position: absolute;
            top: 30px;
            right: 20px;
            width: 80px;
            opacity: 0.9;
        }
        
        .watermark {
            position: absolute;
            bottom: 30px;
            right: 30px;
            opacity: 0.04;
            font-size: 180px;
            font-weight: 800;
            color: var(--primary-color);
            pointer-events: none;
            z-index: 0;
            font-family: 'Playfair Display', serif;
            transform: rotate(-15deg);
        }
        
        .security-features {
            position: absolute;
            top: 20px;
            left: 20px;
            font-size: 11px;
            color: var(--muted-text);
            writing-mode: vertical-rl;
            transform: rotate(180deg);
            letter-spacing: 1px;
        }
        
        .print-button {
            position: fixed;
            bottom: 40px;
            right: 40px;
            z-index: 100;
            width: 70px;
            height: 70px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 26px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.2);
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            border: none;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        
        .print-button:hover {
            transform: scale(1.1) rotate(5deg);
            box-shadow: 0 12px 30px rgba(0, 0, 0, 0.3);
        }
        
        .print-button::after {
            content: "Print Transcript";
            position: absolute;
            right: 85px;
            white-space: nowrap;
            background: var(--primary-color);
            color: white;
            padding: 8px 15px;
            border-radius: 5px;
            font-size: 14px;
            opacity: 0;
            pointer-events: none;
            transition: all 0.3s ease;
        }
        
        .print-button:hover::after {
            opacity: 1;
            right: 75px;
        }
        
        .qr-code {
            position: absolute;
            bottom: 30px;
            left: 30px;
            width: 80px;
            height: 80px;
            background: white;
            padding: 5px;
            border: 1px solid var(--border-color);
            box-shadow: 0 3px 10px rgba(0,0,0,0.05);
        }
        
        @media (max-width: 768px) {
            .transcript-container {
                width: 100%;
                padding: 20px;
                margin: 10px 0;
            }
            
            .student-profile {
                flex-direction: column;
            }
            
            .profile-picture {
                margin: 0 auto 25px;
            }
            
            .student-info {
                padding: 0;
                width: 100%;
            }
            
            .info-grid {
                grid-template-columns: 1fr;
            }
            
            .summary-cards {
                grid-template-columns: 1fr;
            }
            
            .footer-note {
                max-width: 100%;
                margin-bottom: 40px;
            }
            
            .print-button {
                width: 60px;
                height: 60px;
                font-size: 24px;
                bottom: 20px;
                right: 20px;
            }
        }
        
        @media print {
            body {
                background: none;
                padding: 0;
                margin: 0;
            }
            
            .transcript-container {
                box-shadow: none;
                margin: 0;
                border: none;
                width: 100%;
                padding: 0;
                min-height: 100vh;
            }
            
            .print-button {
                display: none;
            }
            
            .watermark {
                opacity: 0.08;
            }
            
            .security-features {
                display: block;
            }
        }
    </style>

    <div class="transcript-container">
        <div class="watermark">JRIT</div>
        <div class="security-features">SECURE DOCUMENT • DO NOT DUPLICATE</div>
        
        <!-- Transcript Header -->
        <div class="transcript-header">
            <div class="institute-logo">
                <img src="{{ url_for('static', filename='images/logo.png') }}" alt="Institute Logo">
            </div>
            <div class="document-title">OFFICIAL ACADEMIC TRANSCRIPT</div>
            <div class="document-subtitle">JR Institute of Information Technology</div>
            <div class="header-border"></div>
        </div>
        
        <!-- Student Profile -->
        <div class="student-profile">
            <div class="profile-picture">
                <img src="{{ url_for('static', filename='uploads/profiles/' + (student.profile_picture if student and student.profile_picture else 'default_profile.jpg')) }}" 
                     alt="{{ student.full_name if student else 'Student' }}">
            </div>
            
            <div class="student-info">
                <h2>STUDENT INFORMATION</h2>
                <div class="info-grid">
                    <div class="info-item">
                        <span class="info-label">Full Name:</span>
                        <span class="info-value">{{ student.full_name if student else 'Not Available' }}</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">Student ID:</span>
                        <span class="info-value">{{ student.id if student else 'N/A' }}</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">Program:</span>
                        <span class="info-value">{{ student.course if student and student.course else 'Not Specified' }}</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">Enrollment Date:</span>
                        <span class="info-value">{{ student.enrollment_date.strftime('%d %b %Y') if student and student.enrollment_date else 'N/A' }}</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">Academic Year:</span>
                        <span class="info-value">2023-2024</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">Transcript Date:</span>
                        <span class="info-value">
                            {% if now is defined and now is not none and now is not string %}
                                {{ now.strftime('%d %B %Y') }}
                            {% else %}
                                N/A
                            {% endif %}
                        </span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">Transcript ID:</span>
                        <span class="info-value">{{ transcript_id if transcript_id else 'N/A' }}</span>
                    </div>
                    <div class="info-item">
                        <span class="info-label">Status:</span>
                        <span class="info-value">
                            <span class="badge bg-success">Active</span>
                        </span>
                    </div>
                </div>
            </div>
        </div>
        
       
        <div class="academic-summary">
            <div class="section-title">ACADEMIC SUMMARY</div>
            
            <div class="summary-cards">
                <div class="summary-card">
                    <h3>Overall GPA</h3>
                    <div class="summary-value overall-gpa">{{ overall_gpa|default('0.0', true) }}</div>
                    <p>Out of 4.0 Scale</p>
                </div>
                
                <div class="summary-card">
                    <h3>Credits Earned</h3>
                    <div class="summary-value">{{ overall_credits|default('0', true) }}</div>
                    <p>Total Credit Hours</p>
                </div>
                
                <div class="summary-card">
                    <h3>Pass Rate</h3>
                    <div class="summary-value pass-rate">
                        {% if total_subjects and total_subjects > 0 %}
                            {{ ((passed_subjects/total_subjects)*100)|round(1) }}%
                        {% else %}
                            0%
                        {% endif %}
                    </div>
                    <p>
                        {% if total_subjects and total_subjects > 0 %}
                            {{ passed_subjects }} of {{ total_subjects }} Subjects
                        {% else %}
                            0 of 0 Subjects
                        {% endif %}
                    </p>
                </div>
                
                <div class="summary-card">
                    <h3>Best Subject</h3>
                    <div class="summary-value" style="color: var(--success-color);">
                        {{ best_subject.subject if best_subject else 'N/A' }}
                    </div>
                    <p>
                        Grade: <strong>{{ best_subject.grade if best_subject else 'N/A' }}</strong> 
                        (GPA: {{ best_subject.gpa if best_subject else 'N/A' }})
                    </p>
                </div>
                
                <div class="summary-card">
                    <h3>Needs Improvement</h3>
                    <div class="summary-value" style="color: var(--warning-color);">
                        {{ worst_subject.subject if worst_subject else 'N/A' }}
                    </div>
                    <p>
                        Grade: <strong>{{ worst_subject.grade if worst_subject else 'N/A' }}</strong> 
                        (GPA: {{ worst_subject.gpa if worst_subject else 'N/A' }})
                    </p>
                </div>
                
                <div class="summary-card">
                    <h3>Completion Status</h3>
                    <div class="summary-value" style="font-size: 28px;">
                        {% if completion_percentage %}
                            {{ completion_percentage|round(1) }}%
                        {% else %}
                            0%
                        {% endif %}
                    </div>
                    <p>of program requirements completed</p>
                </div>
            </div>
        </div>
        
        <!-- Semester-wise Results -->
        <div class="academic-record">
            <div class="section-title">ACADEMIC RECORD</div>
            
            {% if transcript_data %}
                {% for semester in sorted_semesters %}
                {% set data = transcript_data[semester] %}
                <div class="semester-section">
                    <div class="semester-header">
                        <div class="semester-title">SEMESTER {{ semester }}</div>
                        <div class="semester-gpa">
                            GPA: {{ data.semester_gpa|round(2)|default('0.0', true) }} | 
                            Credits: {{ data.semester_credits|default('0', true) }}
                        </div>
                    </div>
                    
                    <table class="subject-table">
                        <thead>
                            <tr>
                                <th>Code</th>
                                <th>Subject</th>
                                <th>Type</th>
                                <th>Credits</th>
                                <th>Marks</th>
                                <th>Grade</th>
                                <th>GPA</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for subject in data.subjects %}
                            <tr>
                                <td>{{ subject.subject_code }}</td>
                                <td>{{ subject.subject_name }}</td>
                                <td>
                                    <span class="badge 
                                        {% if subject.subject_type == 'Theory' %}bg-primary
                                        {% elif subject.subject_type == 'Practical' %}bg-info
                                        {% elif subject.subject_type == 'Lab' %}bg-warning
                                        {% else %}bg-secondary
                                        {% endif %}">
                                        {{ subject.subject_type }}
                                    </span>
                                </td>
                                <td>{{ subject.credits }}</td>
                                <td>{{ subject.marks }}%</td>
                                <td>
                                    <span class="grade-badge grade-{{ subject.grade[0] if subject.grade else 'F' }}">
                                        {{ subject.grade }}
                                    </span>
                                </td>
                                <td>{{ subject.gpa }}</td>
                            </tr>
                            {% endfor %}
                            <tr style="background-color: rgba(0,0,0,0.02);">
                                <td colspan="3" style="font-weight: 600;">Semester Summary</td>
                                <td>{{ data.semester_credits|default('0', true) }}</td>
                                <td colspan="2">{{ data.semester_gpa|round(2)|default('0.0', true) }} GPA</td>
                                <td>
                                    {% if data.semester_gpa and data.semester_gpa >= 2.0 %}
                                        <span class="badge bg-success">Passed</span>
                                    {% else %}
                                        <span class="badge bg-danger">Failed</span>
                                    {% endif %}
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                {% endfor %}
            {% else %}
                <div class="alert alert-info">
                    <i class="fas fa-info-circle me-2"></i> No academic records available.
                </div>
            {% endif %}
        </div>
       
        <div class="transcript-footer">
            <div class="footer-note">
                <p><strong>Official Transcript Note:</strong> This document is the official academic record from JR Institute of Information Technology. Any alteration or duplication without proper authorization is prohibited. This transcript contains security features that will be visible under UV light and when photocopied.</p>
                <p class="mt-3"><strong>Issued on:</strong> 
                    {% if now is defined and now is not none and now is not string %}
                        {{ now.strftime('%d %B %Y') }}
                    {% else %}
                        N/A
                    {% endif %}
                </p>
                <p><strong>Transcript ID:</strong> {{ transcript_id if transcript_id else 'N/A' }}</p>
            </div>
            
            <div class="signature-area">
                <img src="{{ url_for('static', filename='images/signature_stamp.png') }}" class="signature-stamp" alt="Official Stamp">
                <div class="signature-line"></div>
                <div class="signature-text">Registrar's Signature</div>
                <p>JR Institute of Information Technology</p>
            </div>
        </div>
        
        <div class="qr-code">
            <img src="{{ qr_code_url if qr_code_url else url_for('static', filename='images/default_qr.png') }}" alt="Verification QR Code" width="80" height="80">
        </div>
    </div>
    
    <button class="print-button" onclick="window.print()" title="Print Transcript">
        <i class="fas fa-print"></i>
    </button>
    
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            
            const animateElements = [
                ...document.querySelectorAll('.summary-card'),
                ...document.querySelectorAll('.semester-section'),
                document.querySelector('.student-profile'),
                document.querySelector('.transcript-header')
            ];
            
            animateElements.forEach((el, index) => {
                el.style.opacity = '0';
                el.style.transform = 'translateY(30px)';
                el.style.transition = `opacity 0.6s ease ${index * 0.1}s, transform 0.6s ease ${index * 0.1}s`;
                
                setTimeout(() => {
                    el.style.opacity = '1';
                    el.style.transform = 'translateY(0)';
                }, 100);
            });
            
            // Add hover effect to grade badges
            const gradeBadges = document.querySelectorAll('.grade-badge');
            gradeBadges.forEach(badge => {
                badge.addEventListener('mouseenter', () => {
                    badge.style.transform = 'scale(1.1)';
                });
                badge.addEventListener('mouseleave', () => {
                    badge.style.transform = 'scale(1)';
                });
            });
            
            // Print dialog enhancement
            const printButton = document.querySelector('.print-button');
            printButton.addEventListener('click', () => {
                setTimeout(() => {
                    if (window.matchMedia) {
                        const mediaQueryList = window.matchMedia('print');
                        mediaQueryList.addListener(mql => {
                            if (!mql.matches) {
                                // Print dialog was closed
                                window.location.reload();
                            }
                        });
                    }
                }, 500);
            });
        });
    </script>
{% endblock %}